option(ZFP_BUILD_TESTING_SMALL "Enable small-sized array testing" ON)
if(ZFP_BUILD_TESTING_SMALL)
  add_executable(testzfp-small testzfp.cpp fields.c)
  target_link_libraries(testzfp-small zfp)
  foreach(D IN ITEMS 1 2 3)
    foreach(P IN ITEMS 32 64)
      add_test(NAME small-arrays-${D}d-fp${P} COMMAND testzfp-small ${D} ${P})
    endforeach()
  endforeach()
endif()

option(ZFP_BUILD_TESTING_MEDIUM "Enable medium-sized array testing" OFF)
if(ZFP_BUILD_TESTING_MEDIUM)
  add_executable(testzfp-medium testzfp.cpp fields.c)
  target_compile_definitions(testzfp-medium PRIVATE TESTZFP_MEDIUM_ARRAYS)
  target_link_libraries(testzfp-medium zfp)
  foreach(D IN ITEMS 1 2 3)
    foreach(P IN ITEMS 32 64)
      add_test(NAME medium-arrays-${D}d-fp${P} COMMAND testzfp-medium ${D} ${P})
    endforeach()
  endforeach()
endif()

option(ZFP_BUILD_TESTING_LARGE "Enable large array testing" OFF)
if(ZFP_BUILD_TESTING_LARGE)
  add_executable(testzfp-large testzfp.cpp fields.c)
  target_compile_definitions(testzfp-large PRIVATE TESTZFP_LARGE_ARRAYS)
  target_link_libraries(testzfp-large zfp)
  foreach(D IN ITEMS 1 2 3)
    foreach(P IN ITEMS 32 64)
      add_test(NAME large-arrays-${D}d-fp${P} COMMAND testzfp-large ${D} ${P})
    endforeach()
  endforeach()
endif()
